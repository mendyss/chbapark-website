<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>זמני היום ופרשת השבוע</title>
    <style>
        /* CSS בסיסי כדי שייראה נחמד */
        body { font-family: Assistant, Arial, sans-serif; max-width: 600px; margin: 20px auto; padding: 15px; border: 1px solid #eee; border-radius: 8px; }
        h1, h2 { color: #2c3e50; }
        #location { color: #3498db; }
        ul { list-style-type: none; padding: 0; }
        li { background-color: #f9f9f9; margin-bottom: 5px; padding: 10px; border-radius: 4px; }
        li strong { color: #333; }
    </style>
</head>
<body>

    <h1>זמני היום והלכה</h1>
    <h2 id="parasha_title">טוען את פרשת השבוע...</h2>

    <hr>

    <h2>זמנים עבור <span id="location">טוען מיקום...</span></h2>
    <ul>
        <li><strong>עלות השחר:</strong> <span id="alot_hashachar">...</span></li>
        <li><strong>זריחה:</strong> <span id="sunrise">...</span></li>
        <li><strong>סוף זמן קריאת שמע:</strong> <span id="sof_zman_ksh">...</span></li>
        <li><strong>חצות היום:</strong> <span id="chatzot">...</span></li>
        <li><strong>שקיעה:</strong> <span id="sunset">...</span></li>
        <li><strong>צאת הכוכבים:</strong> <span id="tzeit_hakochavim">...</span></li>
    </ul>

    <script>
        // פונקציה זו רצה אוטומטית כשהדף נטען
document.addEventListener('DOMContentLoaded', function() {
    // קוראים לשתי הפונקציות כדי להביא את המידע
    fetchZmanim();
    fetchParasha();
});

// פונקציה להבאת והצגת זמני היום
function fetchZmanim() {
    // ה-ID של באר שבע. אפשר לשנות לכל עיר אחרת
    const geonameid = '295530'; 
    // כתובת ה-API לזמנים
    const zmanimUrl = `https://www.hebcal.com/zmanim?cfg=json&geonameid=${geonameid}`;

    fetch(zmanimUrl)
        .then(response => {
            // נוודא שהתשובה תקינה מהשרת
            if (!response.ok) {
                throw new Error('בעיית רשת בקבלת הזמנים');
            }
            return response.json(); // המר את התשובה לאובייקט JSON
        })
        .then(data => {
            // עדכון המיקום בדף
            document.getElementById('location').textContent = data.location.title;
            
            // עדכון הזמנים בדף
            // הפונקציה toLocaleTimeString ממירה את התאריך המלא לשעה קריאה בעברית
            document.getElementById('alot_hashachar').textContent = new Date(data.times.alot_hashachar).toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('sunrise').textContent = new Date(data.times.sunrise).toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('sof_zman_ksh').textContent = new Date(data.times.sof_zman_krishm_ma).toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('chatzot').textContent = new Date(data.times.chatzot).toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('sunset').textContent = new Date(data.times.sunset).toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
            document.getElementById('tzeit_hakochavim').textContent = new Date(data.times.tzeit_hakochavim).toLocaleTimeString('he-IL', {hour: '2-digit', minute:'2-digit'});
        })
        .catch(error => {
            // טיפול בשגיאות אם ה-API לא עובד או אם יש בעיית רשת
            console.error('שגיאה בהבאת זמני היום:', error);
            // נציג הודעת שגיאה למשתמש
            document.getElementById('location').textContent = "נכשל בטעינת הזמנים";
        });
}

// פונקציה להבאת והצגת פרשת השבוע
function fetchParasha() {
    // כתובת API נכונה שמביאה את האירועים לחודש הנוכחי (כולל פרשה)
    // הוספתי c=on כדי לקבל גם זמני הדלקת נרות
    const parashaUrl = 'https://www.hebcal.com/hebcal?v=1&cfg=json&maj=on&min=off&mod=off&nx=off&c=on';

    fetch(parashaUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error('בעיית רשת בקבלת הפרשה');
            }
            return response.json();
        })
        .then(data => {
            // נמצא את הפריט הראשון שהוא פרשת השבוע מתוך כל האירועים
            const parashaItem = data.items.find(item => item.category === 'parashat');
            
            if (parashaItem) {
                document.getElementById('parasha_title').textContent = parashaItem.title;
            } else {
                document.getElementById('parasha_title').textContent = "פרשת השבוע לא נמצאה כרגע";
            }
        })
        .catch(error => {
            console.error('שגיאה בהבאת פרשת השבוע:', error);
            document.getElementById('parasha_title').textContent = "נכשל בטעינת הפרשה";
        });
}


    </script>

</body>
</html>
